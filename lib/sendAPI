#!/bin/bash
set -e
BASE_URI=https://api.github.com
API_HEADER="Accept: application/vnd.github.v3+json"
AUTH_HEADER="authorization: token $GITHUB_TOKEN"
REPO_FULLNAME=$(jq -r ".repository.full_name" "$GITHUB_EVENT_PATH")
AGENT_HEADER="User-Agent: Actions-$REPO_FULLNAME"

echo $REPO_FULLNAME

method=POST

issueNum=$(jq -r ".issue.number" "$GITHUB_EVENT_PATH")
path="repos/$REPO_FULLNAME/issues/${issueNum}/comments"
msg="test message"
body="{\"body\": \"$msg\"}"

echo curl -i -X $method -s -H ${AUTH_HEADER} -H "${AGENT_HEADER}" -H "${API_HEADER}" "${BASE_URI}/${path}" --data $body
curl -i -X $method -s -H ${AUTH_HEADER} -H "${AGENT_HEADER}" -H "${API_HEADER}" "${BASE_URI}/${path}" --data $body
